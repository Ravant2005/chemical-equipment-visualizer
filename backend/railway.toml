# Railway configuration for Django backend

[build]
builder = "NIXPACKS"

[deploy]
# PRE-DEPLOY: migrations + collectstatic
preDeployCommand = "python manage.py migrate --noinput && python manage.py collectstatic --noinput"

# START: only gunicorn
startCommand = "gunicorn backend.wsgi:application --bind 0.0.0.0:$PORT --workers 2 --timeout 120"

# Health check
healthcheckPath = "/api/health/"

restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
